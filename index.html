<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aura Dash</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-color: #FDF6F0;
            --text-color: #333;
            --subtle-text-color: #666;
            --accent-color: #E57373; /* Default accent color */
            --border-color: rgba(0, 0, 0, 0.07);
            --card-bg: rgba(255, 255, 255, 0.7);
            --shadow-color: rgba(93, 64, 55, 0.1);
            --priority-high: #E57373;
            --priority-medium: #FFB74D;
            --priority-low: #81C784;
        }

        /* --- Base Styles & Dynamic Background --- */
        body {
            font-family: 'Poppins', sans-serif;
            color: var(--text-color);
            margin: 0;
            min-height: 100vh;
            box-sizing: border-box;
            display: flex;
            justify-content: center;
            padding: 3rem 2rem;
            position: relative;
            background-color: var(--bg-color); /* Fallback color */
            background-size: cover;
            background-position: center;
            transition: background-image 1.5s ease-in-out;
        }
        
        body::before {
            content: '';
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background-color: rgba(255, 255, 255, 0.3);
            z-index: -1;
        }

        /* --- Main Layout --- */
        .dashboard-container {
            width: 100%;
            max-width: 1200px;
            display: grid;
            grid-template-columns: minmax(0, 2fr) minmax(0, 1.2fr);
            grid-template-rows: auto 1fr;
            gap: 2.5rem;
            align-items: start;
            z-index: 1;
        }
        
        /* --- Content Section Style --- */
        .content-section {
            background: var(--card-bg);
            border: 1px solid rgba(255,255,255,0.8);
            border-radius: 20px;
            padding: 2rem;
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            box-shadow: 0 6px 20px var(--shadow-color);
        }

        .section-title {
            margin-top: 0;
            margin-bottom: 1.5rem;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text-color);
        }
        
        /* --- Header: Date Display & Navigation --- */
        .header { grid-column: 1 / -1; text-align: center; padding-bottom: 1rem; }
        .date-container { display: flex; justify-content: center; align-items: center; gap: 1.5rem; }
        #current-date { font-size: 2.25rem; font-weight: 700; color: var(--text-color); text-shadow: 0 1px 3px rgba(0,0,0,0.1); }
        .nav-arrow { font-size: 2.5rem; cursor: pointer; user-select: none; color: var(--subtle-text-color); transition: color 0.2s ease; }
        .nav-arrow:hover { color: var(--accent-color); }

        /* --- To-Do List --- */
        .todo-section { grid-column: 1 / 2; grid-row: 2 / 3; }
        .add-task-container { display: flex; gap: 10px; margin-bottom: 1.5rem; }
        #task-input { flex-grow: 1; padding: 14px; border: 1px solid var(--border-color); border-radius: 10px; background: #FFFFFF; color: var(--text-color); font-size: 1rem; box-sizing: border-box; font-family: 'Poppins', sans-serif;}
        #task-priority { padding: 14px; border: 1px solid var(--border-color); border-radius: 10px; background: #FFFFFF; font-family: 'Poppins', sans-serif; }
        #task-input::placeholder { color: var(--subtle-text-color); }
        #task-list { list-style: none; padding: 0; margin: 0; max-height: 50vh; overflow-y: auto; }
        #task-list li { display: flex; align-items: center; padding: 14px 5px; border-bottom: 1px solid var(--border-color); line-height: 1.5; border-left: 5px solid transparent; transition: background-color 0.2s; }
        #task-list li.priority-high { border-left-color: var(--priority-high); }
        #task-list li.priority-medium { border-left-color: var(--priority-medium); }
        #task-list li.priority-low { border-left-color: var(--priority-low); }
        #task-list li:last-child { border-bottom: none; }
        .task-checkbox { margin-right: 15px; width: 20px; height: 20px; accent-color: var(--accent-color); cursor: pointer; flex-shrink: 0; }
        .task-text { flex-grow: 1; cursor: text; outline: none; font-size: 1rem; }
        .task-text.completed { text-decoration: line-through; opacity: 0.6; }
        .delete-btn { background: none; border: none; color: var(--subtle-text-color); font-size: 1.2rem; cursor: pointer; opacity: 0.5; transition: opacity 0.2s, color 0.2s; margin-left: 10px; }
        .delete-btn:hover { opacity: 1; color: #D32F2F; }

        /* --- Widgets Column --- */
        .widgets-column { grid-column: 2 / 3; grid-row: 2 / 3; display: flex; flex-direction: column; gap: 2.5rem; }
        
        /* --- YouTube Player --- */
        #youtube-search-input { width: 100%; padding: 12px; border: 1px solid var(--border-color); border-radius: 10px; background: #FFFFFF; color: var(--text-color); font-size: 1rem; margin-bottom: 1rem; box-sizing: border-box; font-family: 'Poppins', sans-serif;}
        .video-wrapper { position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; border-radius: 12px; background-color: #E0E0E0; }
        .video-wrapper iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }
        #youtube-results { list-style: none; padding: 0; margin-top: 1rem; max-height: 200px; overflow-y: auto; }
        #youtube-results li { padding: 10px; cursor: pointer; border-radius: 8px; transition: background-color 0.2s; font-size: 0.9rem; }
        #youtube-results li:hover { background-color: rgba(0,0,0,0.05); }

        /* --- News Section --- */
        .news-header { display: flex; gap: 10px; margin-bottom: 1.5rem; align-items: center; }
        .news-header label { font-weight: 500; }
        #news-topic { padding: 10px; border: 1px solid var(--border-color); border-radius: 10px; background: #FFFFFF; font-family: 'Poppins', sans-serif; flex-grow: 1;}
        #news-list { list-style: none; padding: 0; margin: 0; max-height: 300px; overflow-y: auto; }
        #news-list li a { text-decoration: none; color: var(--text-color); display: block; padding: 12px 5px; border-bottom: 1px solid var(--border-color); font-size: 0.9rem; transition: background-color 0.2s; border-radius: 8px; }
        #news-list li a:hover { background-color: rgba(0,0,0,0.05); }
        #news-list li:last-child a { border-bottom: none; }


        /* --- Responsive Design --- */
        @media (max-width: 900px) { .dashboard-container { grid-template-columns: 1fr; } .todo-section, .widgets-column { grid-column: 1 / -1; } }
        @media (max-width: 768px) { body { padding: 1.5rem 1rem; } .content-section { padding: 1.5rem; } #current-date { font-size: 1.75rem; } }
    </style>
</head>
<body>
    <div class="dashboard-container">
        <header class="header">
            <div class="date-container">
                <span class="nav-arrow" id="prev-day">&lt;</span>
                <h1 id="current-date"></h1>
                <span class="nav-arrow" id="next-day">&gt;</span>
            </div>
        </header>

        <div class="content-section todo-section">
            <h2 class="section-title">Today's Focus</h2>
            <div class="add-task-container">
                <input type="text" id="task-input" placeholder="Add a new task and press Enter...">
                <select id="task-priority">
                    <option value="medium">Medium</option>
                    <option value="high">High</option>
                    <option value="low">Low</option>
                </select>
            </div>
            <ul id="task-list"></ul>
        </div>

        <div class="widgets-column">
            <div class="content-section">
                <div class="news-header">
                    <label for="news-topic" class="section-title" style="margin-bottom: 0;">News:</label>
                    <select id="news-topic">
                        <option value="technology">Technology</option>
                        <option value="business">Business</option>
                        <option value="science">Science</option>
                        <option value="health">Health</option>
                        <option value="sports">Sports</option>
                    </select>
                </div>
                <ul id="news-list"></ul>
            </div>

            <div class="content-section">
                <h2 class="section-title">Video Search</h2>
                <input type="text" id="youtube-search-input" placeholder="Search YouTube and press Enter...">
                <div class="video-wrapper">
                    <iframe id="youtube-player" src="" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                </div>
                <ul id="youtube-results"></ul>
            </div>
        </div>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        // --- DOM References ---
        const taskInput = document.getElementById('task-input');
        const taskPriorityInput = document.getElementById('task-priority');
        const taskList = document.getElementById('task-list');
        const currentDateEl = document.getElementById('current-date');
        const prevDayBtn = document.getElementById('prev-day');
        const nextDayBtn = document.getElementById('next-day');
        const youtubePlayer = document.getElementById('youtube-player');
        const youtubeSearchInput = document.getElementById('youtube-search-input');
        const youtubeResultsEl = document.getElementById('youtube-results');
        const newsTopicSelect = document.getElementById('news-topic');
        const newsList = document.getElementById('news-list');

        // --- State ---
        let currentDate = new Date();
        let tasks = {};

        // --- Dynamic Background & Theme ---
        const themes = [
            { image: 'https://images.unsplash.com/photo-1506744038136-46273834b3fb?q=80&w=2070&auto=format&fit=crop', accent: '#E57373' },
            { image: 'https://images.unsplash.com/photo-1554141318-133a9d33658a?q=80&w=2070&auto=format&fit=crop', accent: '#64B5F6' },
            { image: 'https://images.unsplash.com/photo-1501854140801-50d01698950b?q=80&w=2175&auto=format&fit=crop', accent: '#81C784' },
            { image: 'https://images.unsplash.com/photo-1562624326-30002161163d?q=80&w=2070&auto=format&fit=crop', accent: '#FFB74D' },
            { image: 'https://images.unsplash.com/photo-1470770841072-f978cf4d019e?q=80&w=2070&auto=format&fit=crop', accent: '#BA68C8' }
        ];
        let currentThemeIndex = -1;
        
        function changeTheme(isInitial = false) {
            currentThemeIndex = (currentThemeIndex + 1) % themes.length;
            const newTheme = themes[currentThemeIndex];
            
            if (isInitial) {
                const img = new Image();
                img.onload = () => {
                    document.body.style.backgroundImage = `url('${newTheme.image}')`;
                    document.documentElement.style.setProperty('--accent-color', newTheme.accent);
                };
                img.src = newTheme.image;
            } else {
                 document.body.style.backgroundImage = `url('${newTheme.image}')`;
                 document.documentElement.style.setProperty('--accent-color', newTheme.accent);
            }
        }

        function preloadSubsequentImages() {
            for (let i = 1; i < themes.length; i++) {
                const img = new Image();
                img.src = themes[i].image;
            }
        }
        
        // --- Date Formatting ---
        const getFormattedDate = (date) => date.toISOString().split('T')[0];
        const displayDate = (date) => {
            currentDateEl.textContent = date.toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });
        };

        // --- Task Management ---
        const saveTasks = () => localStorage.setItem('auraDashTasks', JSON.stringify(tasks));
        const loadTasks = () => { tasks = JSON.parse(localStorage.getItem('auraDashTasks') || '{}'); };
        const renderTasks = () => {
            const dateKey = getFormattedDate(currentDate);
            const isReadOnly = dateKey !== getFormattedDate(new Date());
            taskList.innerHTML = '';
            let dayTasks = tasks[dateKey] || [];
            
            const priorityOrder = { 'high': 1, 'medium': 2, 'low': 3 };
            dayTasks.sort((a, b) => priorityOrder[a.priority] - priorityOrder[b.priority]);

            if (dayTasks.length === 0) {
                taskList.innerHTML = `<li style="color: var(--subtle-text-color); justify-content: center; border-left: none;">No tasks for this day. Add one above!</li>`;
            } else {
                dayTasks.forEach((task, index) => {
                    const li = document.createElement('li');
                    li.className = `priority-${task.priority}`;
                    li.innerHTML = `
                        <input type="checkbox" class="task-checkbox" ${task.completed ? 'checked' : ''} ${isReadOnly ? 'disabled' : ''}>
                        <span class="task-text ${task.completed ? 'completed' : ''}" contenteditable="${!isReadOnly}">${task.text}</span>
                        <button class="delete-btn" style="display: ${isReadOnly ? 'none' : 'inline'};">✖</button>`;
                    taskList.appendChild(li);
                    li.querySelector('.task-checkbox').addEventListener('change', (e) => {
                        dayTasks[index].completed = e.target.checked;
                        li.querySelector('.task-text').classList.toggle('completed', e.target.checked);
                        saveTasks();
                    });
                    li.querySelector('.task-text').addEventListener('blur', (e) => {
                        dayTasks[index].text = e.target.innerText;
                        saveTasks();
                    });
                    li.querySelector('.delete-btn').addEventListener('click', () => {
                        tasks[dateKey].splice(index, 1);
                        saveTasks();
                        renderTasks();
                    });
                });
            }
            document.querySelector('.add-task-container').style.display = isReadOnly ? 'none' : 'flex';
        };
        taskInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter' && taskInput.value.trim() !== '') {
                e.preventDefault();
                const dateKey = getFormattedDate(currentDate);
                if (!tasks[dateKey]) tasks[dateKey] = [];
                tasks[dateKey].push({ 
                    text: taskInput.value.trim(), 
                    completed: false,
                    priority: taskPriorityInput.value 
                });
                taskInput.value = '';
                saveTasks();
                renderTasks();
            }
        });

        // --- Day Navigation & Carry-over ---
        prevDayBtn.addEventListener('click', () => { currentDate.setDate(currentDate.getDate() - 1); displayDate(currentDate); renderTasks(); });
        nextDayBtn.addEventListener('click', () => {
            const today = new Date(); today.setHours(0, 0, 0, 0);
            if (currentDate < today) { currentDate.setDate(currentDate.getDate() + 1); displayDate(currentDate); renderTasks(); }
        });
        const carryOverTasks = () => {
            const lastVisit = localStorage.getItem('auraDashLastVisit');
            const today = getFormattedDate(new Date());
            if (lastVisit && lastVisit !== today) {
                const yesterday = getFormattedDate(new Date(new Date().setDate(new Date().getDate() - 1)));
                const uncompleted = (tasks[yesterday] || []).filter(t => !t.completed);
                if (uncompleted.length > 0 && confirm('Carry over uncompleted tasks from yesterday?')) {
                    tasks[today] = [...(tasks[today] || []), ...uncompleted];
                    saveTasks();
                }
            }
            localStorage.setItem('auraDashLastVisit', today);
        };

        // --- News Feed ---
        const NEWS_API_KEY = "3db2d68c1d894cc6af393cf9e656c7ad"; // <-- PASTE YOUR NEWSAPI.ORG KEY HERE
        async function fetchNews(topic) {
            if (!NEWS_API_KEY) {
                newsList.innerHTML = `<li>Please add a NewsAPI.org key in the code to fetch news.</li>`;
                return;
            }
            const url = `https://newsapi.org/v2/top-headlines?country=us&category=${topic}&apiKey=${NEWS_API_KEY}`;
            try {
                const response = await fetch(url);
                const data = await response.json();
                newsList.innerHTML = '';
                if (data.status === 'ok' && data.articles.length > 0) {
                    data.articles.slice(0, 10).forEach(article => { // Show top 10
                        const li = document.createElement('li');
                        li.innerHTML = `<a href="${article.url}" target="_blank">${article.title}</a>`;
                        newsList.appendChild(li);
                    });
                } else {
                    newsList.innerHTML = '<li>Could not fetch news.</li>';
                }
            } catch (error) {
                console.error("Error fetching news:", error);
                newsList.innerHTML = '<li>Could not fetch news.</li>';
            }
        }
        newsTopicSelect.addEventListener('change', (e) => fetchNews(e.target.value));

        // --- YouTube Player ---
        const YOUTUBE_API_KEY = ""; // <-- PASTE YOUR YOUTUBE DATA API v3 KEY HERE
        async function searchAndPlayYoutube(query) {
            if (!YOUTUBE_API_KEY) {
                youtubeSearchInput.value = "";
                youtubeSearchInput.placeholder = "Add API Key in code to search!";
                return;
            }
            const url = `https://www.googleapis.com/youtube/v3/search?part=snippet&q=${encodeURIComponent(query)}&type=video&maxResults=5&key=${YOUTUBE_API_KEY}`;
            try {
                const response = await fetch(url);
                const data = await response.json();
                youtubeResultsEl.innerHTML = '';
                if (data.items && data.items.length > 0) {
                    data.items.forEach(item => {
                        const li = document.createElement('li');
                        li.textContent = item.snippet.title;
                        li.dataset.videoId = item.id.videoId;
                        youtubeResultsEl.appendChild(li);
                    });
                } else {
                    youtubeResultsEl.innerHTML = '<li>No videos found.</li>';
                }
            } catch (error) { console.error("Error fetching YouTube video:", error); }
        }
        youtubeSearchInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter' && youtubeSearchInput.value.trim() !== '') searchAndPlayYoutube(youtubeSearchInput.value.trim());
        });
        youtubeResultsEl.addEventListener('click', (e) => {
            if (e.target.tagName === 'LI' && e.target.dataset.videoId) {
                const videoId = e.target.dataset.videoId;
                const embedUrl = `https://www.youtube.com/embed/${videoId}?autoplay=1`;
                youtubePlayer.src = embedUrl;
                localStorage.setItem('auraDashYoutubeUrl', embedUrl);
                youtubeResultsEl.innerHTML = '';
            }
        });
        const loadYoutubeUrl = () => {
            const savedUrl = localStorage.getItem('auraDashYoutubeUrl');
            youtubePlayer.src = savedUrl || "https://www.youtube.com/embed/jfKfPfyJRdk";
        };

        // --- Initial Load Function ---
        const initializeDashboard = () => {
            loadTasks();
            carryOverTasks();
            displayDate(currentDate);
            renderTasks();
            loadYoutubeUrl();
            fetchNews(newsTopicSelect.value); // Fetch initial news
            
            // Set initial theme smoothly and preload others
            changeTheme(true); 
            preloadSubsequentImages();
            
            // Start rotating themes after the first one is set
            setInterval(changeTheme, 60000); 
        };
        initializeDashboard();
    });
    </script>
</body>
</html>
