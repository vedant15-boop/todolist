<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aura Dash</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-color: #FDF6F0;
            --text-color: #5D4037;
            --subtle-text-color: #A1887F;
            --accent-color: #E57373;
            --border-color: #EFEBE9;
            --card-bg: rgba(255, 255, 255, 0.6);
            --shadow-color: rgba(93, 64, 55, 0.08);
        }

        /* --- Base Styles & Animated Background --- */
        body {
            font-family: 'Poppins', sans-serif;
            color: var(--text-color);
            margin: 0;
            background-color: var(--bg-color);
            min-height: 100vh;
            box-sizing: border-box;
            display: flex;
            justify-content: center;
            padding: 3rem 2rem;
            position: relative;
        }

        .background-shapes div {
            position: fixed; /* Use fixed to keep them in viewport */
            border-radius: 50%;
            opacity: 0.1;
            animation: float 20s infinite ease-in-out;
            z-index: 0;
        }

        .shape1 { width: 200px; height: 200px; background: #E57373; top: 10%; left: 15%; animation-duration: 25s; }
        .shape2 { width: 150px; height: 150px; background: #81C784; bottom: 15%; right: 20%; animation-duration: 30s; animation-delay: 5s; }
        .shape3 { width: 100px; height: 100px; background: #64B5F6; top: 20%; right: 10%; animation-duration: 20s; }
        .shape4 { width: 250px; height: 250px; background: #FFD54F; bottom: 5%; left: 5%; animation-duration: 35s; animation-delay: 2s; }

        @keyframes float {
            0% { transform: translateY(0px) translateX(0px) rotate(0deg); }
            50% { transform: translateY(-30px) translateX(20px) rotate(180deg); }
            100% { transform: translateY(0px) translateX(0px) rotate(360deg); }
        }

        /* --- Main Layout --- */
        .dashboard-container {
            width: 100%;
            max-width: 1200px;
            display: grid;
            grid-template-columns: minmax(0, 2fr) minmax(0, 1.2fr);
            grid-template-rows: auto 1fr;
            gap: 2.5rem;
            align-items: start;
            z-index: 1;
        }
        
        /* --- Content Section Style --- */
        .content-section {
            background: var(--card-bg);
            border: 1px solid rgba(255,255,255,0.8);
            border-radius: 20px;
            padding: 2rem;
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            box-shadow: 0 4px 15px var(--shadow-color);
        }

        .section-title {
            margin-top: 0;
            margin-bottom: 1.5rem;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text-color);
        }
        
        /* --- Header: Date Display & Navigation --- */
        .header { grid-column: 1 / -1; text-align: center; padding-bottom: 1rem; }
        .date-container { display: flex; justify-content: center; align-items: center; gap: 1.5rem; }
        #current-date { font-size: 2.25rem; font-weight: 700; color: var(--text-color); }
        .nav-arrow { font-size: 2.5rem; cursor: pointer; user-select: none; color: var(--subtle-text-color); transition: color 0.2s ease; }
        .nav-arrow:hover { color: var(--accent-color); }

        /* --- To-Do List --- */
        .todo-section { grid-column: 1 / 2; grid-row: 2 / 3; }
        #task-input { width: 100%; padding: 14px; border: 1px solid var(--border-color); border-radius: 10px; background: #FFFFFF; color: var(--text-color); font-size: 1rem; margin-bottom: 1.5rem; box-sizing: border-box; font-family: 'Poppins', sans-serif;}
        #task-input::placeholder { color: var(--subtle-text-color); }
        #task-list { list-style: none; padding: 0; margin: 0; max-height: 50vh; overflow-y: auto; }
        #task-list li { display: flex; align-items: center; padding: 14px 5px; border-bottom: 1px solid var(--border-color); line-height: 1.5; }
        #task-list li:last-child { border-bottom: none; }
        .task-checkbox { margin-right: 15px; width: 20px; height: 20px; accent-color: var(--accent-color); cursor: pointer; flex-shrink: 0; }
        .task-text { flex-grow: 1; cursor: text; outline: none; font-size: 1rem; }
        .task-text.completed { text-decoration: line-through; color: var(--subtle-text-color); }
        .delete-btn { background: none; border: none; color: var(--subtle-text-color); font-size: 1.2rem; cursor: pointer; opacity: 0.5; transition: opacity 0.2s, color 0.2s; margin-left: 10px; }
        .delete-btn:hover { opacity: 1; color: #D32F2F; }

        /* --- Widgets Column --- */
        .widgets-column { grid-column: 2 / 3; grid-row: 2 / 3; display: flex; flex-direction: column; gap: 2.5rem; }
        
        /* --- YouTube Player --- */
        #youtube-search-input { width: 100%; padding: 12px; border: 1px solid var(--border-color); border-radius: 10px; background: #FFFFFF; color: var(--text-color); font-size: 1rem; margin-bottom: 1rem; box-sizing: border-box; font-family: 'Poppins', sans-serif;}
        .video-wrapper { position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; border-radius: 12px; background-color: #E0E0E0; }
        .video-wrapper iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }
        #youtube-results { list-style: none; padding: 0; margin-top: 1rem; max-height: 200px; overflow-y: auto; }
        #youtube-results li { padding: 10px; cursor: pointer; border-radius: 8px; transition: background-color 0.2s; font-size: 0.9rem; }
        #youtube-results li:hover { background-color: var(--border-color); }

        /* --- Gemini Assistant --- */
        #gemini-input { width: 100%; padding: 12px; border: 1px solid var(--border-color); border-radius: 10px; background: #FFFFFF; color: var(--text-color); box-sizing: border-box; margin-bottom: 1rem; font-size: 1rem; min-height: 60px; font-family: 'Poppins', sans-serif; resize: vertical;}
        #gemini-submit { width: 100%; padding: 14px; border: none; border-radius: 10px; background: var(--accent-color); color: white; cursor: pointer; font-size: 1rem; font-weight: 600; transition: background-color 0.2s; }
        #gemini-submit:hover { background-color: #E53935; }
        #gemini-submit:disabled { background-color: var(--subtle-text-color); cursor: not-allowed; }
        #gemini-response { margin-top: 1rem; padding-top: 1rem; border-top: 1px solid var(--border-color); white-space: pre-wrap; font-size: 0.95rem; line-height: 1.6; max-height: 200px; overflow-y: auto; }

        /* --- Quick Links --- */
        #quick-links-list { list-style: none; padding: 0; margin: 0; display: grid; grid-template-columns: repeat(auto-fill, minmax(80px, 1fr)); gap: 1rem; }
        .quick-link-item { text-align: center; }
        .quick-link-item a { display: block; background-color: #fff; padding: 15px; border-radius: 10px; text-decoration: none; color: var(--accent-color); font-weight: 600; font-size: 1.5rem; transition: transform 0.2s; }
        .quick-link-item a:hover { transform: scale(1.1); }
        .quick-link-item span { font-size: 0.8rem; margin-top: 5px; display: block; color: var(--subtle-text-color); }
        #add-link-btn { background: none; border: 2px dashed var(--border-color); color: var(--subtle-text-color); width: 100%; height: 100%; border-radius: 10px; cursor: pointer; font-size: 2rem; transition: background-color 0.2s, color 0.2s; }
        #add-link-btn:hover { background-color: var(--border-color); color: var(--text-color); }


        /* --- Responsive Design --- */
        @media (max-width: 900px) {
            .dashboard-container { grid-template-columns: 1fr; }
            .todo-section, .widgets-column { grid-column: 1 / -1; }
        }
        @media (max-width: 768px) {
            body { padding: 1.5rem 1rem; }
            .content-section { padding: 1.5rem; }
            #current-date { font-size: 1.75rem; }
        }
    </style>
</head>
<body>
    <div class="background-shapes">
        <div class="shape1"></div><div class="shape2"></div><div class="shape3"></div><div class="shape4"></div>
    </div>

    <div class="dashboard-container">
        <header class="header">
            <div class="date-container">
                <span class="nav-arrow" id="prev-day">&lt;</span>
                <h1 id="current-date"></h1>
                <span class="nav-arrow" id="next-day">&gt;</span>
            </div>
        </header>

        <div class="content-section todo-section">
            <h2 class="section-title">Today's Focus</h2>
            <input type="text" id="task-input" placeholder="Add a new task and press Enter...">
            <ul id="task-list"></ul>
        </div>

        <div class="widgets-column">
            <div class="content-section">
                 <h2 class="section-title">Gemini Assistant</h2>
                 <div>
                     <textarea id="gemini-input" placeholder="Ask anything..." rows="3"></textarea>
                     <button id="gemini-submit">Ask Gemini</button>
                 </div>
                 <div id="gemini-response">Ask a question to see the response here.</div>
            </div>

            <div class="content-section">
                <h2 class="section-title">Quick Links</h2>
                <ul id="quick-links-list">
                    <!-- Links will be populated here -->
                </ul>
            </div>

            <div class="content-section">
                <h2 class="section-title">Video Search</h2>
                <input type="text" id="youtube-search-input" placeholder="Search YouTube and press Enter...">
                <div class="video-wrapper">
                    <iframe id="youtube-player" src="" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                </div>
                <ul id="youtube-results"></ul>
            </div>
        </div>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        // --- DOM References ---
        const currentDateEl = document.getElementById('current-date');
        const taskInput = document.getElementById('task-input');
        const taskList = document.getElementById('task-list');
        const prevDayBtn = document.getElementById('prev-day');
        const nextDayBtn = document.getElementById('next-day');
        const youtubePlayer = document.getElementById('youtube-player');
        const youtubeSearchInput = document.getElementById('youtube-search-input');
        const youtubeResultsEl = document.getElementById('youtube-results');
        const geminiSubmitBtn = document.getElementById('gemini-submit');
        const geminiResponseEl = document.getElementById('gemini-response');
        const geminiInputEl = document.getElementById('gemini-input');
        const quickLinksList = document.getElementById('quick-links-list');

        // --- State ---
        let currentDate = new Date();
        let tasks = {};
        let quickLinks = [];

        // --- Date Formatting ---
        const getFormattedDate = (date) => date.toISOString().split('T')[0];
        const displayDate = (date) => {
            currentDateEl.textContent = date.toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });
        };

        // --- Task Management ---
        const saveTasks = () => localStorage.setItem('auraDashTasks', JSON.stringify(tasks));
        const loadTasks = () => { tasks = JSON.parse(localStorage.getItem('auraDashTasks') || '{}'); };
        const renderTasks = () => {
            const dateKey = getFormattedDate(currentDate);
            const isReadOnly = dateKey !== getFormattedDate(new Date());
            taskList.innerHTML = '';
            const dayTasks = tasks[dateKey] || [];
            if (dayTasks.length === 0) {
                taskList.innerHTML = `<li style="color: var(--subtle-text-color); justify-content: center;">No tasks for this day. Add one above!</li>`;
            } else {
                dayTasks.forEach((task, index) => {
                    const li = document.createElement('li');
                    li.innerHTML = `
                        <input type="checkbox" class="task-checkbox" ${task.completed ? 'checked' : ''} ${isReadOnly ? 'disabled' : ''}>
                        <span class="task-text ${task.completed ? 'completed' : ''}" contenteditable="${!isReadOnly}">${task.text}</span>
                        <button class="delete-btn" style="display: ${isReadOnly ? 'none' : 'inline'};">✖</button>`;
                    taskList.appendChild(li);
                    li.querySelector('.task-checkbox').addEventListener('change', (e) => {
                        tasks[dateKey][index].completed = e.target.checked;
                        li.querySelector('.task-text').classList.toggle('completed', e.target.checked);
                        saveTasks();
                    });
                    li.querySelector('.task-text').addEventListener('blur', (e) => {
                        tasks[dateKey][index].text = e.target.innerText;
                        saveTasks();
                    });
                    li.querySelector('.delete-btn').addEventListener('click', () => {
                        tasks[dateKey].splice(index, 1);
                        saveTasks();
                        renderTasks();
                    });
                });
            }
            taskInput.style.display = isReadOnly ? 'none' : 'block';
        };
        taskInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter' && taskInput.value.trim() !== '') {
                e.preventDefault();
                const dateKey = getFormattedDate(currentDate);
                if (!tasks[dateKey]) tasks[dateKey] = [];
                tasks[dateKey].push({ text: taskInput.value.trim(), completed: false });
                taskInput.value = '';
                saveTasks();
                renderTasks();
            }
        });

        // --- Day Navigation & Carry-over ---
        prevDayBtn.addEventListener('click', () => { currentDate.setDate(currentDate.getDate() - 1); displayDate(currentDate); renderTasks(); });
        nextDayBtn.addEventListener('click', () => {
            const today = new Date(); today.setHours(0, 0, 0, 0);
            if (currentDate < today) { currentDate.setDate(currentDate.getDate() + 1); displayDate(currentDate); renderTasks(); }
        });
        const carryOverTasks = () => {
            const lastVisit = localStorage.getItem('auraDashLastVisit');
            const today = getFormattedDate(new Date());
            if (lastVisit && lastVisit !== today) {
                const yesterday = getFormattedDate(new Date(new Date().setDate(new Date().getDate() - 1)));
                const uncompleted = (tasks[yesterday] || []).filter(t => !t.completed);
                if (uncompleted.length > 0 && confirm('Carry over uncompleted tasks from yesterday?')) {
                    tasks[today] = [...(tasks[today] || []), ...uncompleted];
                    saveTasks();
                }
            }
            localStorage.setItem('auraDashLastVisit', today);
        };

        // --- Quick Links ---
        const saveQuickLinks = () => localStorage.setItem('auraDashQuickLinks', JSON.stringify(quickLinks));
        const loadQuickLinks = () => { quickLinks = JSON.parse(localStorage.getItem('auraDashQuickLinks') || '[]'); };
        const renderQuickLinks = () => {
            quickLinksList.innerHTML = '';
            quickLinks.forEach((link, index) => {
                const nameInitial = link.name.charAt(0).toUpperCase();
                const li = document.createElement('li');
                li.className = 'quick-link-item';
                li.innerHTML = `<a href="${link.url}" target="_blank" title="${link.name}">${nameInitial}</a>`;
                quickLinksList.appendChild(li);
            });
            const addButtonLi = document.createElement('li');
            addButtonLi.className = 'quick-link-item';
            addButtonLi.innerHTML = `<button id="add-link-btn">+</button>`;
            quickLinksList.appendChild(addButtonLi);
            document.getElementById('add-link-btn').addEventListener('click', () => {
                const name = prompt("Enter a name for the link:");
                if (!name) return;
                const url = prompt("Enter the full URL (e.g., https://example.com):");
                if (!url) return;
                quickLinks.push({ name, url });
                saveQuickLinks();
                renderQuickLinks();
            });
        };

        // --- YouTube Player ---
        const YOUTUBE_API_KEY = ""; // <-- PASTE YOUR YOUTUBE DATA API v3 KEY HERE
        async function searchAndPlayYoutube(query) {
            if (!YOUTUBE_API_KEY) {
                youtubeSearchInput.value = "";
                youtubeSearchInput.placeholder = "Add API Key in code to search!";
                return;
            }
            const url = `https://www.googleapis.com/youtube/v3/search?part=snippet&q=${encodeURIComponent(query)}&type=video&maxResults=5&key=${YOUTUBE_API_KEY}`;
            try {
                const response = await fetch(url);
                const data = await response.json();
                youtubeResultsEl.innerHTML = '';
                if (data.items && data.items.length > 0) {
                    data.items.forEach(item => {
                        const li = document.createElement('li');
                        li.textContent = item.snippet.title;
                        li.dataset.videoId = item.id.videoId;
                        youtubeResultsEl.appendChild(li);
                    });
                } else {
                    youtubeResultsEl.innerHTML = '<li>No videos found.</li>';
                }
            } catch (error) { console.error("Error fetching YouTube video:", error); }
        }
        youtubeSearchInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter' && youtubeSearchInput.value.trim() !== '') searchAndPlayYoutube(youtubeSearchInput.value.trim());
        });
        youtubeResultsEl.addEventListener('click', (e) => {
            if (e.target.tagName === 'LI' && e.target.dataset.videoId) {
                const videoId = e.target.dataset.videoId;
                const embedUrl = `https://www.youtube.com/embed/${videoId}?autoplay=1`;
                youtubePlayer.src = embedUrl;
                localStorage.setItem('auraDashYoutubeUrl', embedUrl);
                youtubeResultsEl.innerHTML = '';
            }
        });
        const loadYoutubeUrl = () => {
            const savedUrl = localStorage.getItem('auraDashYoutubeUrl');
            youtubePlayer.src = savedUrl || "https://www.youtube.com/embed/jfKfPfyJRdk";
        };

        // --- Gemini Assistant ---
        geminiSubmitBtn.addEventListener('click', async () => {
            const userPrompt = geminiInputEl.value.trim();
            if (!userPrompt) return;
            geminiSubmitBtn.disabled = true;
            geminiSubmitBtn.textContent = "Thinking...";
            geminiResponseEl.textContent = "Generating response...";
            const dateKey = getFormattedDate(currentDate);
            const taskContext = (tasks[dateKey] || []).map(t => `- ${t.text} (${t.completed ? 'completed' : 'not completed'})`).join('\n');
            const fullPrompt = `You are a helpful productivity assistant. Here is my current list of tasks for today:\n${taskContext.length > 0 ? taskContext : "I have no tasks yet."}\n\nBased on this context, please answer my question: "${userPrompt}"`;
            try {
                const responseText = await callGeminiApi(fullPrompt);
                geminiResponseEl.textContent = responseText;
            } catch (error) {
                console.error("Gemini API Error:", error);
                geminiResponseEl.textContent = "Sorry, an error occurred. Please check the console for details.";
            } finally {
                geminiSubmitBtn.disabled = false;
                geminiSubmitBtn.textContent = "Ask Gemini";
            }
        });
        async function callGeminiApi(prompt) {
            const apiKey = ""; // Provided by Canvas
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;
            const payload = { contents: [{ parts: [{ text: prompt }] }] };
            const response = await fetch(apiUrl, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(payload) });
            if (!response.ok) throw new Error(`API request failed with status ${response.status}`);
            const result = await response.json();
            if (!result.candidates || result.candidates.length === 0) throw new Error("No candidates returned from API.");
            return result.candidates[0].content.parts[0].text;
        }

        // --- Initial Load Function ---
        const initializeDashboard = () => {
            loadTasks();
            carryOverTasks();
            displayDate(currentDate);
            renderTasks();
            loadYoutubeUrl();
            loadQuickLinks();
            renderQuickLinks();
        };
        initializeDashboard();
    });
    </script>
</body>
</html>
